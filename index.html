<!DOCTYPE html>
<html>

<head>
    <title>CloudApp Contatos</title>
</head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
    crossorigin="anonymous">

<body>
    <h1 style="text-align: center">
        CloudApp Contatos
    </h1>
    <h3>Lista de contatos</h3>

    <table id="contatos" style="width:100%" class="table table-striped">
        <tr>
            <th>Nome</th>
            <th>E-mail</th>
            <th>Telefone</th>
        </tr>
    </table>

    <div class="container py-3">
        <div class="row">
            <div class="mx-auto col-sm-6">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0">Cadastro de Usu&aacute;rio</h4>
                    </div>
                    <div class="card-body">
                        <div class="form-group row">
                            <label class="col-lg-3 col-form-label form-control-label">Nome</label>
                            <div class="col-lg-9">
                                <input class="form-control" placeholder="Nome" id="nome" type="text" value="">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-lg-3 col-form-label form-control-label">Email</label>
                            <div class="col-lg-9">
                                <input class="form-control" type="email" id="email" placeholder="exemplo@email.com">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-lg-3 col-form-label form-control-label">Telefone</label>
                            <div class="col-lg-9">
                                <input class="form-control" type="text" id="telefone" placeholder="(00) 1111-2222">
                            </div>
                        </div>

                        <div class="form-group row">
                            <label class="col-lg-3 col-form-label form-control-label"></label>
                            <div class="col-lg-9">
                                <button id="add-contato">Adicionar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



</body>

<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
<script>


    $(function () {

        var $contatos = $('#contatos');
        var $nome = $('#nome');
        var $email = $('#email');
        var $telefone = $('#telefone');

        $.ajax({
            type: 'GET',
            url: 'https://cloudapp-30scj.herokuapp.com/contato/lista',
            success: function (contatos) {
                console.log('success', contatos);
                $.each(contatos, function (i, contato) {
                    $contatos.append('<tr><td>' + contato.nome + '</td><td>' + contato.email + '</td><td>' + contato.telefone + '</td></tr>');
                });
            },
            error: function () {
                alert('Erro ao carregar contatos!');
            }
        });

        $('#add-contato').on('click', function () {
            var contato = {
                nome: $nome.val(),
                email: $email.val(),
                telefone: $telefone.val(),
            };

            $.ajax({

                type: 'POST',
                url: 'https://cloudapp-30scj.herokuapp.com/contato',
                contentType: "application/json",
                dataType: "json",
                data: JSON.stringify(contato),
                success: function (novoContato) {
                    $contatos.append('<tr><td>' + novoContato.nome + '</td><td>' + novoContato.email + '</td><td>' + novoContato.telefone + '</td></tr>');
                    $nome.val('');
                    $email.val('');
                    $telefone.val('');
                },
                error: function () {
                    alert('Erro ao adicionar contato!');
                }
            });

        });
    });
</script>

</html>